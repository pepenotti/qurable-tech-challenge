<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="799px" preserveAspectRatio="none" style="width:949px;height:799px;background:#FEFEFE;" version="1.1" viewBox="0 0 949 799" width="949px" zoomAndPan="magnify"><title>Coupon Book Service - High-Level Architecture</title><defs/><g><rect fill="#FEFEFE" height="799" style="stroke:none;stroke-width:1;" width="949" x="0" y="0"/><g class="title" data-source-line="4"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="343.0615" x="296.0561" y="23.5352">Coupon Book Service - High-Level Architecture</text></g><!--cluster Application Tier--><g class="cluster" data-entity="Application Tier" data-source-line="8" data-uid="ent0003" id="cluster_Application Tier"><path d="M392.5,217.9783 L508.9043,217.9783 A3.75,3.75 0 0 1 511.4043,220.4783 L518.4043,240.4666 L737.5,240.4666 A2.5,2.5 0 0 1 740,242.9666 L740,650.4883 A2.5,2.5 0 0 1 737.5,652.9883 L392.5,652.9883 A2.5,2.5 0 0 1 390,650.4883 L390,220.4783 A2.5,2.5 0 0 1 392.5,217.9783" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="390" x2="518.4043" y1="240.4666" y2="240.4666"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="115.4043" x="394" y="233.5134">Application Tier</text></g><!--cluster API--><g class="cluster" data-entity="API" data-source-line="9" data-uid="ent0004" id="cluster_API"><rect fill="#87CEEB" height="352.01" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="286" x="422" y="268.9783"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="109.0879" x="510.4561" y="284.5134">FastAPI Service</text></g><!--cluster Data Tier--><g class="cluster" data-entity="Data Tier" data-source-line="16" data-uid="ent0008" id="cluster_Data Tier"><path d="M8.5,451.4983 L76.1299,451.4983 A3.75,3.75 0 0 1 78.6299,453.9983 L85.6299,473.9866 L363.5,473.9866 A2.5,2.5 0 0 1 366,476.4866 L366,789.9783 A2.5,2.5 0 0 1 363.5,792.4783 L8.5,792.4783 A2.5,2.5 0 0 1 6,789.9783 L6,453.9983 A2.5,2.5 0 0 1 8.5,451.4983" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="85.6299" y1="473.9866" y2="473.9866"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="66.6299" x="10" y="467.0334">Data Tier</text></g><!--cluster DB--><g class="cluster" data-entity="DB" data-source-line="17" data-uid="ent0009" id="cluster_DB"><path d="M38,512.4983 C38,502.4983 186,502.4983 186,502.4983 C186,502.4983 334,502.4983 334,512.4983 L334,750.4783 C334,760.4783 186,760.4783 186,760.4783 C186,760.4783 38,760.4783 38,750.4783 L38,512.4983" fill="#4169E1" style="stroke:#181818;stroke-width:1;"/><path d="M38,512.4983 C38,522.4983 186,522.4983 186,522.4983 C186,522.4983 334,522.4983 334,512.4983" fill="none" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="82.5918" x="144.7041" y="538.0334">PostgreSQL</text></g><!--cluster Deployment--><g class="cluster" data-entity="Deployment" data-source-line="24" data-uid="ent0013" id="cluster_Deployment"><path d="M162.5,43.4883 L250.3848,43.4883 A3.75,3.75 0 0 1 252.8848,45.9883 L259.8848,65.9766 L345.5,65.9766 A2.5,2.5 0 0 1 348,68.4766 L348,138.4783 A2.5,2.5 0 0 1 345.5,140.9783 L162.5,140.9783 A2.5,2.5 0 0 1 160,138.4783 L160,45.9883 A2.5,2.5 0 0 1 162.5,43.4883" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="160" x2="259.8848" y1="65.9766" y2="65.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="86.8848" x="164" y="59.0234">Deployment</text></g><!--entity REST API--><g class="entity" data-entity="REST API" data-source-line="10" data-uid="ent0005" id="entity_REST API"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.6934" x="465.65" y="311.9783"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58.6934" x="475.65" y="335.5134">REST API</text></g><!--entity Async/Await--><g class="entity" data-entity="Async.Await" data-source-line="11" data-uid="ent0006" id="entity_Async.Await"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="104.7725" x="579.61" y="311.9783"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84.7725" x="589.61" y="335.5134">Async/Await</text></g><!--entity Business Logic--><g class="entity" data-entity="Business Logic" data-source-line="12" data-uid="ent0007" id="entity_Business Logic"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="119.1279" x="466.44" y="560.4983"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.1279" x="476.44" y="584.0334">Business Logic</text></g><!--entity Coupon Data--><g class="entity" data-entity="Coupon Data" data-source-line="18" data-uid="ent0010" id="entity_Coupon Data"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.6895" x="61.66" y="560.4983"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.6895" x="71.66" y="584.0334">Coupon Data</text></g><!--entity User Data--><g class="entity" data-entity="User Data" data-source-line="19" data-uid="ent0011" id="entity_User Data"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.9805" x="205.01" y="560.4983"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65.9805" x="215.01" y="584.0334">User Data</text></g><!--entity Audit Logs--><g class="entity" data-entity="Audit Logs" data-source-line="20" data-uid="ent0012" id="entity_Audit Logs"><rect fill="#F1F1F1" height="36.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="92.8027" x="69.6" y="699.9883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.8027" x="79.6" y="723.5234">Audit Logs</text></g><!--entity Docker--><g class="entity" data-entity="Docker" data-source-line="25" data-uid="ent0014" id="entity_Docker"><path d="M186.2162,87.8218 C188.0235,82.8635 192.6925,82.5676 195.9142,86.2306 C199.2425,80.3412 205.8218,79.0728 209.6102,85.7283 C212.4925,81.0247 216.3688,80.3156 219.6169,85.3526 C223.2544,79.9749 229.4483,78.8993 232.4753,85.9826 C235.4737,80.3754 239.6693,80.6366 243.3933,85.204 C245.5193,78.7264 250.3054,78.0981 254.5187,83.1983 C259.2657,78.4832 263.697,78.5499 266.8002,85.0055 C270.5438,79.5017 276.0635,80.309 278.6569,86.2021 C281.5755,80.6656 287.2406,81.0209 290.3607,85.9773 C293.5385,80.7377 297.1567,81.3538 300.8086,85.4464 C304.7537,79.5973 310.3146,81.3077 312.9779,86.8195 C316.3395,80.7358 322.4867,80.0795 325.9404,86.7257 C333.0319,89.342 336.2246,96.5332 329.3351,102.2138 C336.7525,108.91 332.837,115.6185 324.8759,117.9596 C321.6385,122.9535 317.2949,123.2105 313.4541,118.6834 C310.4614,124.7359 305.5701,126.2894 300.6336,120.8522 C297.4013,126.5212 292.8034,126.5189 288.9742,121.5034 C287.1247,127.4077 282.925,128.3667 278.3144,124.5226 C274.9905,129.6584 269.6852,129.8146 266.6531,124.2058 C264.1281,129.8182 258.8858,132.6075 254.2257,126.4626 C250.4108,130.5991 244.3567,130.935 242.579,124.2667 C238.8774,129.135 234.9053,128.161 232.7899,122.7553 C228.7961,129.0242 223.4876,128.0673 220.6023,121.6873 C217.0697,127.5462 211.9985,127.0234 209.2103,120.9752 C204.1364,125.7714 198.8339,125.7863 195.8896,118.6065 C192.5528,122.8868 187.9487,121.8752 185.6472,117.3959 C176.4697,116.7174 172.9207,112.6514 177.4058,103.7321 C172.4737,94.6026 176.4866,88.8323 186.2162,87.8218" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="125.7402" x="191.13" y="107.0234">Docker Containers</text></g><!--entity Users--><g class="entity" data-entity="Users" data-source-line="6" data-uid="ent0002" id="entity_Users"><ellipse cx="430.0027" cy="71.9883" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M430.0027,79.9883 L430.0027,106.9883 M417.0027,87.9883 L443.0027,87.9883 M430.0027,106.9883 L417.0027,121.9883 M430.0027,106.9883 L443.0027,121.9883" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.4854" x="384.26" y="137.0234">Users/Clients</text></g><g class="entity" data-entity="GMN19" data-source-line="35" data-uid="ent0020" id="entity_GMN19"><path d="M755.83,286.9483 L755.83,373.501 L942.1738,373.501 L942.1738,296.9483 L932.1738,286.9483 L755.83,286.9483" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M932.1738,286.9483 L932.1738,296.9483 L942.1738,296.9483 L932.1738,286.9483" fill="#FEFFDD" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="89.3306" x="761.83" y="304.5166">Key Features:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.6035" x="761.83" y="319.8272">&#8226; RESTful API design</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.8374" x="761.83" y="335.1377">&#8226; Async operations</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.7769" x="761.83" y="350.4483">&#8226; Swagger docs (/docs)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.3438" x="761.83" y="365.7588">&#8226; State machine validation</text></g><g class="entity" data-entity="GMN22" data-source-line="43" data-uid="ent0023" id="entity_GMN22"><path d="M755.83,535.4683 L755.83,622.021 L918.1669,622.021 L918.1669,545.4683 L908.1669,535.4683 L755.83,535.4683" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M908.1669,535.4683 L908.1669,545.4683 L918.1669,545.4683 L908.1669,535.4683" fill="#FEFFDD" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="141.3369" x="761.83" y="553.0366">Concurrency Control:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.3213" x="761.83" y="568.3472">&#8226; SELECT FOR UPDATE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.228" x="761.83" y="583.6577">&#8226; SKIP LOCKED</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.1538" x="761.83" y="598.9683">&#8226; ACID transactions</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.6855" x="761.83" y="614.2788">&#8226; Pessimistic locking</text></g><g class="entity" data-entity="GMN25" data-source-line="51" data-uid="ent0026" id="entity_GMN25"><path d="M134.46,294.6083 L134.46,365.8505 A0,0 0 0 0 134.46,365.8505 L373.5337,365.8505 A0,0 0 0 0 373.5337,365.8505 L373.5337,304.6083 L363.5337,294.6083 L258,294.6083 L254,125.2783 L250,294.6083 L134.46,294.6083 A0,0 0 0 0 134.46,294.6083" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M363.5337,294.6083 L363.5337,304.6083 L373.5337,304.6083 L363.5337,294.6083" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83.8906" x="140.46" y="312.1766">Deployment:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.9307" x="140.46" y="327.4872">&#8226; Docker Compose (dev)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.0737" x="140.46" y="342.7977">&#8226; AWS ECS / GCP Cloud Run (prod)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.417" x="140.46" y="358.1083">&#8226; Horizontal scaling ready</text></g><!--link Users to API--><g class="link" data-entity-1="Users" data-entity-2="API" data-source-line="29" data-uid="lnk15" id="link_Users_API"><path d="M430,140.3883 C430,172.0883 430,218.3283 430,257.117 C430,259.5413 430,261.9365 430,264.2972 C430,265.4776 430,266.6493 430,267.8118 C430,268.1024 430,262.3924 430,262.6819" fill="none" id="Users-to-API" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="430,268.6819,434,259.6819,430,263.6819,426,259.6819,430,268.6819" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.4844" x="431" y="183.5466">HTTP/REST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30.748" x="450.8682" y="198.8572">JSON</text></g><!--link API to DB--><g class="link" data-entity-1="API" data-entity-2="DB" data-source-line="30" data-uid="lnk16" id="link_API_DB"><path d="M421.9938,339.6906 C421.9192,339.7703 421.8441,339.8504 421.7687,339.931 C421.6179,340.0922 421.4654,340.2552 421.3114,340.4199 C421.0034,340.7494 420.6891,341.086 420.3689,341.4292 C415.2453,346.9214 408.6006,354.137 401.7613,361.8208 C388.0825,377.1883 373.625,394.4283 369,403.4983 C351.17,438.4783 340.475,481.2358 334.2112,515.6408 C334.1623,515.9096 335.1808,510.2735 335.1324,510.5413" fill="none" id="API-to-DB" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="334.0653,516.4456,339.6022,508.3006,334.9546,511.5253,331.7298,506.8777,334.0653,516.4456" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.502" x="371.4695" y="417.0666">SQL Queries</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.4409" x="370" y="432.3772">Row Locking</text></g><!--link Docker to API--><g class="link" data-entity-1="Docker" data-entity-2="API" data-source-line="31" data-uid="lnk17" id="link_Docker_API"><path d="M287.23,125.3483 C322.96,150.2183 376.57,189.3883 391,209.9783 C398.8775,221.2158 405.24,234.1439 410.3559,247.25 C412.9139,253.803 415.1602,260.4006 417.1285,266.8535 C418.1126,270.08 419.0272,273.2703 419.8765,276.4009 C420.3011,277.9662 420.7094,279.5165 421.1019,281.0489 C421.2982,281.8151 421.4905,282.5769 421.6789,283.3338 C421.7731,283.7122 420.4363,278.2623 420.5285,278.6383" fill="none" id="Docker-to-API" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="421.9586,284.4654,423.6982,274.7714,420.7669,279.6095,415.9288,276.6781,421.9586,284.4654" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.6548" x="385" y="191.0466">Hosts</text></g><!--link Docker to DB--><g class="link" data-entity-1="Docker" data-entity-2="DB" data-source-line="32" data-uid="lnk18" id="link_Docker_DB"><path d="M186.27,125.4483 C147.69,142.2583 102.66,169.3983 80,209.9783 C44.57,273.4383 36.84,315.0283 80,373.4983 C142.7,458.4483 238.49,363.1683 307,443.4983 C316.6225,454.7833 322.6594,468.6445 326.2927,483.1305 C327.201,486.752 327.9591,490.4125 328.5854,494.0816 C328.8986,495.9161 329.1788,497.7528 329.4284,499.5878 C329.5532,500.5053 328.9566,495.465 329.0663,496.3812" fill="none" id="Docker-to-DB" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/><polygon fill="#181818" points="329.7801,502.3385,332.681,492.9266,329.1853,497.3741,324.7379,493.8783,329.7801,502.3385" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.6548" x="81" y="335.2966">Hosts</text></g><!--link API to GMN19--><g class="link" data-entity-1="API" data-entity-2="GMN19" data-source-line="35" data-uid="lnk21" id="link_API_GMN19"><path d="M426.3153,268.3532 C426.329,268.1051 426.343,267.8568 426.3575,267.6082 C426.3864,267.1111 426.417,266.6131 426.4492,266.1141 C426.5138,265.1163 426.5852,264.1149 426.6638,263.1108 C429.1775,230.9783 439.03,195.9683 467.5,179.4783 C508.84,155.5383 637.92,162.2983 682.5,179.4783 C737.99,200.8683 786.45,250.2683 816.57,286.7183" fill="none" id="API-GMN19" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/></g><!--link DB to GMN22--><g class="link" data-entity-1="DB" data-entity-2="GMN22" data-source-line="43" data-uid="lnk24" id="link_DB_GMN22"><path d="M334.2526,560.7173 C334.3414,560.5357 334.4308,560.3529 334.521,560.169 C334.7014,559.8013 334.8845,559.4291 335.0704,559.0526 C335.8141,557.5464 336.6022,555.9704 337.4345,554.3306 C344.0928,541.2123 353.5731,524.0102 365.6513,505.7795 C389.8075,469.3183 424.355,428.7433 467.5,408.4983 C554.01,367.9183 595.13,369.8083 682.5,408.4983 C740.53,434.1983 786.07,493.6483 812.26,535.0083" fill="none" id="DB-GMN22" style="stroke:#181818;stroke-width:1;stroke-dasharray:7,7;"/></g><!--SRC=[RPF1Zjem48RlUOeH74gHM7QbgYqSAeKG2WMLBCcgXsuFnl5cBOmTsGw8hLRgi_JH-YGTcm0fQdA8yezdvfi_4xFXiYIQR65DwARGgf9vf8JIq9x4xWxC-GHLsr999crg3uA1PjGIMGWM19PR529LOHn6IcqWPNh7AOCUJ7dnt5km7HCGQlhCBQPL6fC8jTYczM2ODlr8S2niMa0CU2K8IWGY1ODMM9Q2Ks8v5iyuqotu6G1UPnveJOYnOJ8xjVLbt7lxuuSeZaTrWhk-h-8qSx4V5oaq1qdxuPvmsr17bU6I6GCBLN1w3Bm6hmsmCR7a7w8SXJKn64gKiOLcwVt2iun7q7vtztuGtpLHQiDScKPVD_wr5bOvjmx4_9U3bK8TjkZ4sHgXgXm3YcwmMAIa9JYBFlfRg-t1RHmFRbsbD-w8n0-35fl0-m-ztYTluH2cMPRqdMsFyakw_1eurKLng27WX71VCSsPUPGhjKT8YXjJ17MNcvjp6RJ4D6MVVrG3gInk5AwA1VNa4d2CRdVE3Z1XnEsB6NQxgFtvzHiSobCbVDcS6Lx8Ek2_8wYIQNASv2YdUr8Ks3DNr42dxnvlJo5BiE-Mu5vA1ZiYUEvJ0oPpS4pNPEEH1qExQAKra_JWtTLANFZIU1576KoMAtX8nc4Md_JvB875Cfh7unDmD1k3rKGQGfl42QuTtt9ZEGLH-tb5j5RMggr7yevwhCiYN6ZEEu0_2svc9sUxq_JXjnJYA8K-V8uIYFpEh2e9dLAh_7HegZH_SGiam50qI1RuvvFyS07w2m00]--></g></svg>